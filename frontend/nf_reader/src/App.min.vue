<script setup>import{ ref} from "vue";// --- Lógica original da sua aplicação (NÃO MODIFICADA) ---const API_URL="http://localhost:5000"; // Sua URL de APIconst fileInput=ref(null);const isDragging=ref(false);const isProcessing=ref(false);const error=ref(null);const result=ref(null);const handleFileSelect=(event)=>{ const file=event.target.files[0]; if (file) processFile(file)};const handleDrop=(event)=>{ isDragging.value=false; const file=event.dataTransfer.files[0]; if (file) processFile(file)};const processFile=async (file)=>{ const allowedTypes=["application/pdf", "image/jpeg", "image/png"]; if (!allowedTypes.includes(file.type)){ error.value="Tipo de arquivo não suportado. Use PDF, PNG ou JPEG."; return;} try{ error.value=null; isProcessing.value=true; result.value=null; const formData=new FormData(); formData.append("file", file); const response=await fetch(`${API_URL}/api/process-invoice`,{ method: "POST", body: formData,}); const data=await response.json(); if (!response.ok){ throw new Error(data.error || "Erro ao processar nota fiscal");} result.value=data;} catch (err){ console.error("Erro:", err); error.value=err.message;} finally{ isProcessing.value=false;}};const resetForm=()=>{ result.value=null; error.value=null; if (fileInput.value) fileInput.value.value=""; isDragging.value=false};// --- Fim da lógica original ---// Lógica para o novo layout AdminLTEconst activeTab=ref('processar_nf');const sidebarOpen=ref(true);const navigateTo=(tabName)=>{ activeTab.value=tabName; if (window.innerWidth < 768){ sidebarOpen.value=false;}};const toggleSidebar=()=>{ sidebarOpen.value=!sidebarOpen.value};const menuItems=[ { id: 'processar_nf', label: 'Processar NF', icon: 'M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2zM7 8v2h10V8H7zm0 4v2h10v-2H7zm0 4v2h7v-2H7z'}, { id: 'historico', label: 'Histórico', icon: 'M12 8v4l3 3m6-3a9 9 0 1 1-18 0 9 9 0 0 1 18 0z'}, { id: 'configuracoes', label: 'Configurações', icon: 'M19.14 12.94c.04-.3.06-.61.06-.94s-.02-.64-.07-.94l2.03-1.58a.49.49 0 0 0 .12-.61l-1.92-3.32a.488.488 0 0 0-.58-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54a.484.484 0 0 0-.48-.41H9.72a.484.484 0 0 0-.48.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96a.488.488 0 0 0-.58.22l-1.92 3.32a.49.49 0 0 0 .12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58a.49.49 0 0 0-.12.61l1.92 3.32c.12.22.37.33.58.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.34.36.6.68.6h3.84c.32 0 .63-.26.68-.6l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47-.02.58-.22l1.92-3.32a.49.49 0 0 0-.12-.61l-2.01-1.58zM12 15.6a3.6 3.6 0 1 1 0-7.2 3.6 3.6 0 0 1 0 7.2z'}, { id: 'ajuda', label: 'Ajuda', icon: 'M12 2a10 10 0 1 0 0 20 10 10 0 0 0 0-20zm-1.18 15.03L9.5 17V9.83l.03-.58.18-.45.9-.88c.6-.6 1-1 1-1.47a1 1 0 0 0-1-1 .94.94 0 0 0-.7.29l-.28.33L7.1 9.17l.02-.02a2.77 2.77 0 0 1 2.1-1.03c1.3 0 2.3.88 2.3 2.17 0 .66-.33 1.21-.88 1.7l-1 1v.7h3.03v1.68h-3.2zM12 18.88a1.2 1.2 0 1 1 0-2.4 1.2 1.2 0 0 1 0 2.4z'}];</script><template><div class="admin-layout"><header class="admin-header"><button class="sidebar-toggle" @click="toggleSidebar" aria-label="Toggle Sidebar"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></button><div class="app-logo-header">Leitor NF-e Admin</div></header><aside class="admin-sidebar" :class="{ 'open': sidebarOpen}"><div class="sidebar-header"><span class="app-logo-sidebar">Leitor NF-e</span></div><nav class="sidebar-nav"><ul><li v-for="item in menuItems" :key="item.id" :class="{ 'active': activeTab===item.id}"><a @click.prevent="navigateTo(item.id)"><svg class="menu-icon" viewBox="0 0 24 24" fill="currentColor" stroke="none" width="20" height="20"><path :d="item.icon" /></svg><span>{{ item.label}}</span></a></li></ul></nav></aside><main class="admin-content" :class="{ 'sidebar-open': sidebarOpen}"><div v-if="activeTab==='processar_nf'"><header class="page-header"><h1>Leitor de Notas Fiscais</h1><p>Faça o upload de notas fiscais em PDF ou imagem.</p></header><div class="content-area"><div class="upload-area" :class="{ 'is-dragging': isDragging}" @dragenter.prevent="isDragging=true" @dragleave.prevent="isDragging=false" @dragover.prevent @drop.prevent="handleDrop"><input type="file" ref="fileInput" class="file-input-hidden" @change="handleFileSelect" accept=".pdf,.png,.jpg,.jpeg" /><div v-if="!isProcessing && !result" class="upload-area-content"><svg class="upload-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3 3m0 0l-3-3m3 3V8" /></svg><p class="upload-text">Arraste e solte um arquivo aqui ou <button type="button" @click="$refs.fileInput.click()" class="upload-browse-button">clique para selecionar </button></p><p class="upload-hint">PDF, PNG, JPG ou JPEG</p></div><div v-if="isProcessing" class="processing-indicator"><div class="spinner"></div><p>Processando nota fiscal...</p></div></div><div v-if="error" class="error-message">{{ error}}</div><div v-if="result" class="results-section"><h2 class="results-title">Dados Extraídos</h2><div class="card results-card"><div class="results-grid"><div class="result-item"><p class="result-label">Número da NF</p><p class="result-value">{{ result["numero_da_nota_fiscal"]}}</p></div><div class="result-item"><p class="result-label">Data de Emissão</p><p class="result-value">{{ result["data_de_emissao"]}}</p></div><div class="result-item"><p class="result-label">Valor Total</p><p class="result-value">R${{ result["valor_total"]}}</p></div><div class="result-item"><p class="result-label">CNPJ Emitente</p><p class="result-value">{{ result["CNPJ_do_emitente"]}}</p></div></div><div class="result-group-flex"><div class="flex-item-emitente-nome"><p class="result-label">Nome Emitente</p><p class="result-value">{{ result["nome/razao_social_do_emitente"]}} </p></div><div class="flex-item-emitente-endereco"><p class="result-label">Endereço</p><p class="result-value">{{ result["endereco_do_emitente"]}}</p></div></div><div class="result-group"><p class="result-label">Chave de Acesso</p><p class="result-value break-all">{{ result["chave_de_acesso"]}}</p></div><div v-if="result['lista_de_itens'] && result['lista_de_itens'].length >0" class="result-group"><h3 class="items-title">Itens da Nota</h3><div class="items-list"><div v-for="(item, index) in result['lista_de_itens']" :key="index" class="item-entry"><p class="item-description">{{ item["descricao"]}}</p><div class="item-details-grid"><div><span class="item-detail-label">Valor: </span><span class="item-detail-value">R${{ item["valor_unitario"]}}</span></div><div><span class="item-detail-label">Qtd: </span><span class="item-detail-value">{{ item["quantidade"]}}</span></div><div><span class="item-detail-label">Total: </span><span class="item-detail-value">R${{ item["valor_total"]}}</span></div></div></div></div></div></div><div class="new-invoice-action"><button @click="resetForm" class="btn btn-primary btn-gradient-hover">Processar Nova Nota </button></div></div></div></div><div v-if="activeTab==='historico'" class="placeholder-content"><h2>Histórico de Notas</h2><p>Esta seção exibirá o histórico de notas fiscais processadas. (Funcionalidade futura)</p></div><div v-if="activeTab==='configuracoes'" class="placeholder-content"><h2>Configurações</h2><p>Esta seção permitirá configurar a aplicação. (Funcionalidade futura)</p></div><div v-if="activeTab==='ajuda'" class="placeholder-content"><h2>Ajuda & Suporte</h2><p>Informações de ajuda e contato para suporte. (Funcionalidade futura)</p></div></main></div></template><style>*,*::before,*::after{ box-sizing: border-box; margin: 0; padding: 0}:root{ --cor-principal: #00a9b3; --gradiente-secundario: linear-gradient(92.99deg, #ef60a3 6.23%, #ff8a3d 99.16%); --cor-sidebar-bg: #2d3748; --cor-sidebar-texto: #e2e8f0; --cor-sidebar-texto-hover: #FFFFFF; --cor-sidebar-item-ativo-bg: var(--cor-principal); --cor-conteudo-bg: #f7fafc; --cor-texto-padrao: #1f2937; --cor-header-texto: #FFFFFF; --sidebar-width: 260px; --header-height: 60px}body{ font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; background-color: var(--cor-conteudo-bg); color: var(--cor-texto-padrao); line-height: 1.6}.admin-layout{ display: flex; flex-direction: column; min-height: 100vh}.admin-header{ height: var(--header-height); background-color: var(--cor-principal); color: var(--cor-header-texto); display: flex; align-items: center; padding: 0 20px; position: fixed; top: 0; left: 0; right: 0; z-index: 1000; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1)}.sidebar-toggle{ background: none; border: none; color: var(--cor-header-texto); cursor: pointer; font-size: 1.5rem; margin-right: 15px; display: none}.app-logo-header{ font-size: 1.5rem; font-weight: 600}.admin-sidebar{ width: var(--sidebar-width); background-color: var(--cor-sidebar-bg); color: var(--cor-sidebar-texto); position: fixed; top: var(--header-height); left: 0; bottom: 0; padding-top: 20px; transition: transform 0.3s ease-in-out; z-index: 999; overflow-y: auto}.admin-sidebar .sidebar-header{ padding: 0 20px 20px 20px; text-align: center; border-bottom: 1px solid rgba(255, 255, 255, 0.1); margin-bottom: 10px}.app-logo-sidebar{ font-size: 1.3rem; font-weight: 500; color: var(--cor-header-texto)}.sidebar-nav ul{ list-style: none}.sidebar-nav li a{ display: flex; align-items: center; padding: 12px 20px; color: var(--cor-sidebar-texto); text-decoration: none; transition: background-color 0.2s ease, color 0.2s ease; gap: 10px}.menu-icon{ color: var(--cor-principal); min-width: 20px}.sidebar-nav li a:hover{ background-color: rgba(255, 255, 255, 0.05); color: var(--cor-sidebar-texto-hover)}.sidebar-nav li a:hover .menu-icon{ color: var(--cor-sidebar-texto-hover)}.sidebar-nav li.active a{ background-color: var(--cor-sidebar-item-ativo-bg); color: var(--cor-header-texto); font-weight: 500}.sidebar-nav li.active a .menu-icon{ color: var(--cor-header-texto)}.admin-content{ margin-top: var(--header-height); margin-left: ; padding: 30px; flex-grow: 1; transition: margin-left 0.3s ease-in-out; background-color: var(--cor-conteudo-bg)}.page-header{ text-align: center; margin-bottom: 2.5rem}.page-header h1{ font-size: 2rem; font-weight: 700; color: #111827; margin-bottom: 0.5rem}.page-header p{ font-size: 1rem; color: #4b5563}.content-area{ max-width: 860px; margin: 0 auto}.upload-area{ border: 2px dashed #cbd5e1; border-radius: 0.75rem; padding: 2.5rem; text-align: center; background-color: #ffffff; transition: border-color 0.2s ease, background-color 0.2s ease; margin-bottom: 1.5rem}.upload-area.is-dragging{ border-color: var(--cor-principal); background-color: #e6f7f8}.file-input-hidden{ display: none}.upload-icon{ margin: 0 auto 1rem auto; height: 3rem; width: 3rem; color: #9ca3af}.upload-text{ margin-top: 1rem; font-size: 1rem; color: #4b5563}.upload-browse-button{ color: var(--cor-principal); font-weight: 600; text-decoration: none; background: none; border: none; cursor: pointer; padding: 0; transition: color 0.2s ease}.upload-browse-button:hover{ background-image: var(--gradiente-secundario); -webkit-background-clip: text; background-clip: text; color: transparent; text-decoration: none}.upload-hint{ margin-top: 0.5rem; font-size: 0.875rem; color: #6b7280}.processing-indicator{ display: flex; flex-direction: column; align-items: center; justify-content: center; color: #4b5563}.spinner{ animation: spin 1s linear infinite; border-radius: 50%; height: 2.5rem; width: 2.5rem; border: 3px solid #e0e7ff; border-top-color: var(--cor-principal); margin-bottom: 1rem}@keyframes spin{ from{ transform: rotate(0deg);} to{ transform: rotate(360deg);}}.error-message{ margin-top: 1rem; margin-bottom: 1.5rem; padding: 1rem 1.25rem; background-color: #fee2e2; color: #b91c1c; border-radius: 0.5rem; border: 1px solid #fca5a5; font-size: 0.9rem}.results-section{ margin-top: 2.5rem}.results-title{ font-size: 1.75rem; font-weight: 600; color: #111827; margin-bottom: 1.5rem; text-align: left}.card{ background-color: #ffffff; border-radius: 0.75rem; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08); padding: 2rem}.results-grid{ display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 1.5rem 2.5rem; margin-bottom: 2rem}.result-group-flex{ display: flex; flex-wrap: wrap; gap: 1.5rem 2.5rem; margin-bottom: 2rem; }.flex-item-emitente-nome{ flex: 1 1 300px; min-width: 250px; }.flex-item-emitente-endereco{ flex: 2 1 350px; min-width: 300px; }.result-group{ margin-bottom: 2rem}.result-group:last-child{ margin-bottom: 0}.result-label{ font-size: 0.875rem; color: #6b7280; margin-bottom: 0.25rem; font-weight: 500}.result-value{ font-size: 1rem; color: #1f2937; font-weight: 500}.result-value.break-all{ word-break: break-all}.items-title{ font-size: 1.25rem; font-weight: 600; color: #1f2937; margin-bottom: 1.25rem; border-top: 1px solid #e5e7eb; padding-top: 1.5rem}.items-list>.item-entry:not(:last-child){ margin-bottom: 1rem}.item-entry{ padding-bottom: 1rem; border-bottom: 1px solid #e5e7eb}.items-list>.item-entry:last-child{ border-bottom: none; padding-bottom: 0; margin-bottom: 0}.item-description{ font-weight: 600; color: #1f2937; margin-bottom: 0.5rem}.item-details-grid{ display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 0.75rem; font-size: 0.875rem}.item-detail-label{ color: #6b7280}.item-detail-value{ color: #1f2937; font-weight: 500}.btn{ display: inline-block; padding: 0.75rem 1.5rem; font-size: 1rem; font-weight: 500; text-align: center; border-radius: 0.5rem; cursor: pointer; transition: background-color 0.2s ease, color 0.2s ease, border-color 0.2s ease, background-image 0.3s ease, opacity 0.2s ease; border: 1px solid transparent}.btn-primary{ background-color: var(--cor-principal); color: #ffffff; border-color: var(--cor-principal)}.btn-primary:hover{ background-color: #008a93; border-color: #008a93}.btn-gradient-hover{ position: relative; z-index: 1; overflow: hidden}.btn-gradient-hover::before{ content: ""; position: absolute; top: 0; right: 0; bottom: 0; left: 0; background-image: var(--gradiente-secundario); z-index: -1; transition: opacity 0.3s ease-in-out; opacity: 0; border-radius: inherit}.btn-gradient-hover:hover::before{ opacity: 1}.btn-gradient-hover:hover{ background-color: var(--cor-principal); color: #ffffff; border-color: transparent}.new-invoice-action{ margin-top: 2rem; text-align: center}.placeholder-content{ padding: 20px; background-color: #fff; border-radius: 8px; box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05)}.placeholder-content h2{ color: var(--cor-principal); margin-bottom: 10px}@media (max-width: 768px){ .sidebar-toggle{ display: block;} .admin-sidebar{ transform: translateX(-100%); box-shadow: 2px 0 5px rgba(0, 0, 0, 0.1);} .admin-sidebar.open{ transform: translateX(0);} .admin-content{ margin-left: 0;} .app-logo-header{ margin-left: auto; margin-right: auto;} .result-group-flex{ gap: 1.5rem 1.5rem; } .flex-item-emitente-nome, .flex-item-emitente-endereco{ flex-basis: 100%; min-width: unset; }}</style>